---
title: Practical 2
date: today
date-format: long
author: Melvil Deleage, Jeff Macaraeg
toc: true
format:
  pdf:
    code-fold: false
    toc: true
    code-block-border-left: "#0d6efd"
    code-block-bg: true
    highlight-style: github
    geometry: margin = 1.5cm
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# load the required packages and install them if they are not.
source(here::here("setup.R"))
```

# Part 1 - Venice

```{r}
load("data/Practical2/niveau.Rdata")
```

## Question a) 

> Read in the data. Extract and represent the yearly max values from 1940 to 2009. What do you observe ?

```{r}
# Load the venice90 dataset
data("venice90", package = "extRemes")

# 1. Parse the timestamp column into Date format
venice90$Date <- as.Date(venice90$Zeitstempel, format = "%Y-%m-%d %H:%M:%S")

# 2. Extract the year
venice90 <- venice90 %>%
  mutate(Year = year(Date))

# 3. Filter for the range 1940–2009
venice_filtered <- venice90 %>%
  filter(Year >= 1940, Year <= 2009)

# 4. Compute yearly maximum values
venice_max <- venice_filtered %>%
  group_by(Year) %>%
  summarise(Max_Sea_Level = max(Wert, na.rm = TRUE), .groups = "drop") %>%
  complete(Year = 1940:2009)  # Ensure all years are shown

# 5. Plot the results
ggplot(venice_max, aes(x = Year, y = Max_Sea_Level)) +
  geom_line(color = "blue", na.rm = TRUE) +
  geom_point(color = "blue", na.rm = TRUE) +
  labs(
    title = "Yearly Maximum Sea Levels at Venice (1940–2009)",
    x = "Year",
    y = "Maximum Sea Level (cm)"
  ) +
  scale_x_continuous(breaks = seq(1940, 2010, 10)) +
  theme_minimal()
```

